ha
 tensor([[-0.0104, -0.0126,  0.0070,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0049, -0.0046,  0.0125,  ...,  0.0000,  0.0000,  0.0000],
        [-0.0173, -0.0161, -0.0205,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [-0.0160,  0.0209, -0.0046,  ...,  0.0000,  0.0000,  0.0000],
        [-0.0070, -0.0209,  0.0096,  ...,  0.0000,  0.0000,  0.0000],
        [-0.0160,  0.0071,  0.0046,  ...,  0.0000,  0.0000,  0.0000]],
       device='cuda:0')
ho true god
 tensor([[-0.0216,  0.0047, -0.0087,  ..., -0.0028, -0.0083, -0.0162],
        [ 0.0105,  0.0128, -0.0160,  ..., -0.0028,  0.0165, -0.0216],
        [ 0.0025,  0.0128,  0.0305,  ...,  0.0222,  0.0211,  0.0025],
        ...,
        [-0.0212,  0.0167, -0.0029,  ...,  0.0312, -0.0118,  0.0172],
        [ 0.0172, -0.0156, -0.0217,  ..., -0.0165, -0.0055,  0.0305],
        [ 0.0075,  0.0215, -0.0123,  ...,  0.0050,  0.0298, -0.0305]],
       device='cuda:0')

(Pdb) p val0
array([-0.01039155, -0.01730157,  0.00494892,  0.00494892,  0.00244725,
        0.00494892, -0.00756843, -0.00756843, -0.02223233, -0.00756843,
       -0.03075194, -0.00756843, -0.02223233, -0.01730157,  0.01730157,
        0.00244725,  0.00244725,  0.01730157, -0.00756843, -0.02223233,
       -0.01039155,  0.00756843, -0.00756843,  0.01730157, -0.01039155,
        0.00494892,  0.02223233, -0.01355268, -0.02223233,  0.01730157,
       -0.02223233, -0.01039155,  0.00244725, -0.00494892,  0.00494892,
       -0.01039155,  0.00244725,  0.00494892,  0.01355268, -0.00494892,
        0.00494892,  0.00494892, -0.00244725,  0.00244725,  0.02223233,
       -0.01355268, -0.03075194,  0.00756843, -0.00244725, -0.01355268,
        0.01355268,  0.00756843,  0.01730157,  0.00494892,  0.01730157,
       -0.00244725, -0.01730157,  0.01730157, -0.03075194, -0.02223233,
       -0.01039155,  0.01355268, -0.01730157, -0.00494892, -0.00240381,
       -0.00240381, -0.00240381, -0.00240381, -0.01699449, -0.02183774,
       -0.01699449,  0.00486108,  0.02183774, -0.00240381,  0.02183774,
        0.01331215, -0.01020712, -0.02183774,  0.0074341 ,  0.00486108,
        0.00240381,  0.00240381,  0.00240381,  0.01020712, -0.02183774,
       -0.01699449, -0.01699449,  0.00486108,  0.02183774, -0.00240381,
       -0.01699449, -0.00486108, -0.02183774, -0.03020615,  0.00486108,
       -0.01020712,  0.01020712,  0.01331215,  0.0074341 ,  0.02183774,
       -0.01020712, -0.02183774,  0.01020712,  0.01699449, -0.03020615,
        0.00486108, -0.0074341 , -0.00486108,  0.00486108,  0.00240381,
       -0.03020615,  0.03020615, -0.01020712, -0.01331215,  0.01331215,
        0.00240381, -0.01699449,  0.02183774,  0.00486108, -0.00486108,
        0.01331215,  0.00240381,  0.03020615, -0.0074341 , -0.00240381,
        0.00240381, -0.0074341 , -0.03020615], dtype=float32)
(Pdb) n
> /home/ghostway/projects/python/bitch/bitch.py(151)_your_dequantize_nf4_kernel()
-> even_offsets = base_offsets * 2
(Pdb) p val1
array([ 0.00494892, -0.00244725, -0.00756843, -0.00756843,  0.01039155,
       -0.01730157, -0.02223233,  0.00494892,  0.01355268, -0.00244725,
        0.01039155,  0.00756843, -0.01730157, -0.01730157, -0.01355268,
        0.00244725,  0.00494892, -0.01039155,  0.00756843,  0.00494892,
        0.00244725,  0.00494892,  0.01039155,  0.00494892,  0.01039155,
        0.01039155,  0.00756843, -0.00756843,  0.01355268,  0.01730157,
       -0.01730157,  0.01355268,  0.00244725,  0.01730157,  0.01039155,
        0.00756843,  0.00244725, -0.01730157,  0.00494892, -0.00244725,
        0.00756843, -0.01039155, -0.00244725, -0.03075194, -0.00494892,
       -0.01730157,  0.01730157,  0.01039155, -0.00244725, -0.00244725,
        0.00494892, -0.02223233, -0.00494892,  0.02223233,  0.00756843,
        0.00756843, -0.00244725, -0.00756843, -0.03075194, -0.00494892,
       -0.01039155, -0.02223233, -0.02223233, -0.01355268, -0.0074341 ,
       -0.02183774,  0.01699449, -0.01331215, -0.01020712, -0.01331215,
        0.0074341 , -0.03020615,  0.00486108, -0.02183774, -0.00240381,
       -0.0074341 , -0.03020615,  0.00486108,  0.00240381,  0.02183774,
        0.00486108,  0.01699449, -0.01020712, -0.01699449,  0.01699449,
        0.02183774,  0.01331215,  0.00486108,  0.00240381, -0.00486108,
       -0.03020615,  0.01020712, -0.02183774,  0.03020615, -0.00240381,
       -0.01699449, -0.02183774,  0.01020712, -0.03020615,  0.01020712,
       -0.00240381,  0.01699449,  0.0074341 , -0.00486108,  0.00486108,
        0.01699449, -0.00486108, -0.00486108,  0.01331215,  0.01331215,
        0.01020712, -0.01331215, -0.0074341 ,  0.0074341 ,  0.00486108,
        0.02183774, -0.0074341 , -0.0074341 ,  0.00486108, -0.03020615,
        0.0074341 ,  0.01331215,  0.01331215,  0.01331215, -0.02183774,
       -0.03020615, -0.00240381, -0.01699449], dtype=float32)

local_abs_max array isn't right, but the difference is so small
I don't think it really matters.
